import Layout from "../Layout";
import { useState } from "react";
import axios from "axios";
import { useRouter } from "next/dist/client/router";
const Login = () => {
  const [user, setUser] = useState("");
  const [password, setPassword] = useState("");
  let router = useRouter();
  const loginEvent = () => {
    if (user) {
      if (password) {
        // All fields contain data
        if (!user.includes(">")) {
          if (!user.includes("<")) {
            if (!password.includes("<")) {
              if (!password.includes(">")) {
                // Valid Data
                let us = document.getElementById("username").value;
                let pas = document.getElementById("password").value;

                loginUser(us, pas);
              }
            }
          }
        }
      }
    }
  };

  const loginUser = (username, password) => {
    axios
      .post("http://localhost:5000/login", {
        user: username,
        pass: password,
      })
      .then((res) => {
        console.log(res);
        if (res.data == "loggedin") {
          router.push("/");
        }
      });
  };
  return (
    <>
      <div className="ml-20 mt-12 align-center self-center text-center">
        <div>
          <b className="text-white">Username: </b>
          <input
            type="text"
            id="username"
            onInput={(e) => setUser(e.target.value)}
            value={user}
          />
        </div>
        <br />
        <div>
          <b className="text-white">Password: </b>
          <input
            type="password"
            id="password"
            onInput={(e) => setPassword(e.target.value)}
            value={password}
          />
        </div>
        <br />
        <button className="bg-lightBlue hover:bg-darkBlue" onClick={loginEvent}>
          Login
        </button>
      </div>
    </>
  );
};

export default Login;
